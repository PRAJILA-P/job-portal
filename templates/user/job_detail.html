{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- Hero Section -->
<section class="section-hero overlay inner-page bg-image d-flex align-items-center"
         style="background: url('{% static "images/hero_1.jpg" %}');
                min-height: 250px; background-size: cover; background-position: center;">
  <div class="container text-center">
    <h1 class="text-white fw-bold display-5 mb-3">{{ job.title }}</h1>
    <div class="custom-breadcrumbs">
      <a href="{% url 'user:account' %}" class="text-white-50 text-decoration-none">Dashboard</a>
      <span class="mx-2 text-white-50">/</span>
      <a href="{% url 'user:view_jobs' %}" class="text-white-50 text-decoration-none">Jobs</a>
      <span class="mx-2 text-white-50">/</span>
      <span class="text-white fw-semibold">{{ job.title }}</span>
    </div>
  </div>
</section>

<!-- Job Details Section -->
<section class="py-5" style="background-color: #f8f9fa;">
  <div class="container">
    <div class="row">

      <!-- Sidebar -->
      <div class="col-lg-3 mb-4">
        <div class="card shadow-lg border-0 rounded-4 p-4 sticky-top" style="top: 20px;">
          <h5 class="fw-bold mb-3 text-primary">Navigation</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-1">
              <a class="nav-link text-dark p-3 rounded-3 hover-bg-primary active-link" 
                 href="{% url 'user:addprofile' %}">
                <i class="icon-edit me-2"></i> Add Profile
              </a>
            </li>
            <li class="nav-item mb-1">
              <a class="nav-link text-dark p-3 rounded-3 hover-bg-primary active-link" 
                 href="{% url 'user:view_jobs' %}">
                <i class="icon-list me-2"></i>View Jobs 
              </a>
            </li>
            <li class="nav-item mb-1">
              <a class="nav-link text-dark p-3 rounded-3 hover-bg-primary active-link" 
                 href="{% url 'user:application_list' %}">
                <i class="icon-list me-2"></i> Application Status
              </a>
            </li>
            <li class="nav-item mb-1">
              <a class="nav-link text-dark p-3 rounded-3 hover-bg-primary" 
                 href="{% url 'user:logout' %}">
                <i class="icon-sign-out me-2"></i> Logout
              </a>
            </li>
          </ul>
        </div>
      </div>

      <!-- Job Details Column -->
      <div class="col-lg-9">
        <div class="card shadow-sm border-0 rounded-4 p-4">
          <!-- <a href="{% url 'chat:start_chat' job.recruiter.id %}" class="btn btn-primary">ðŸ’¬ Live Chat</a> -->


          <!-- Job Header -->
          <div class="d-flex align-items-center mb-4">
            {% if job.recruiter.profile.logo %}
              <img src="{{ job.recruiter.profile.logo.url }}" 
                   alt="Company Logo" 
                   class="rounded-circle me-3 shadow-sm" 
                   style="width: 70px; height: 70px; object-fit: cover;">
            {% else %}
              <div class="bg-light rounded-circle d-flex align-items-center justify-content-center me-3 shadow-sm" 
                   style="width: 70px; height: 70px;">
                <i class="fas fa-building text-dark fs-4"></i>
              </div>
            {% endif %}
            <div>
              <h3 class="fw-bold mb-1" style="color: #89ba16;">{{ job.title }}</h3>
              <small class="text-dark">{{ job.recruiter.company_name }}</small>
            </div>
          </div>

          <!-- Job Info -->
          <p class="text-dark mb-2">
            <i class="fas fa-map-marker-alt me-1"></i> {{ job.location }} |
            <i class="fas fa-briefcase me-1"></i> {{ job.get_job_type_display }}
          </p>
          <p class="text-dark mb-3">
            <i class="fas fa-calendar-alt me-1"></i> Posted: {{ job.posted_at|date:"M d, Y" }}
            {% if job.deadline %}
              | <i class="fas fa-hourglass-end text-danger me-1"></i> Deadline: {{ job.deadline|date:"M d, Y" }}
            {% endif %}
          </p>

          <!-- Job Description -->
          <h5 class="fw-semibold mb-2">Job Description</h5>
          <p class="text-dark">{{ job.description }}</p>

          {% if job.requirements %}
          <h5 class="fw-semibold mb-2">Requirements</h5>
          <p class="text-dark">{{ job.requirements }} </p>
          {% endif %}

          {% if job.roles_and_responsibilities %}
          <h5 class="fw-semibold mb-2">Roles & Responsibilities</h5>
          <ul class="text-dark">
            {% for role in job.roles_and_responsibilities.splitlines %}
              <li>{{ role }}</li>
            {% endfor %}
          </ul>
          {% endif %}

          {% if job.education_required %}
          <h5 class="fw-semibold mb-2">Education Required</h5>
          <p class="text-dark">{{ job.education_required }}</p>
          {% endif %}

          {% if job.experience_required %}
          <h5 class="fw-semibold mb-2">Experience Required</h5>
          <p class="text-dark">{{ job.experience_required }} years</p>
          {% endif %}

          {% if job.salary %}
          <h5 class="fw-semibold mb-2">Salary</h5>
          <p class="text-dark">&#8377; {{ job.salary }}</p>
          {% endif %}

          <!-- Recruiter/Company Details -->
          <hr>
          <h5 class="fw-semibold mb-3">Company Details</h5>
          <p class="text-dark"><strong>Industry:</strong> {{ job.recruiter.profile.industry }}</p>
          <p class="text-dark"><strong>Location:</strong> {{ job.recruiter.profile.location }}</p>
          <p class="text-dark"><strong>Email:</strong> {{ job.recruiter.email }}</p>
          {% if job.recruiter.phone %}
          <p class="text-dark"><strong>Phone:</strong> {{ job.recruiter.phone }}</p>
          {% endif %}
          {% if job.recruiter.profile.company_description %}
          <p class="text-dark"><strong>About Company:</strong> {{ job.recruiter.profile.company_description }}</p>
          {% endif %}
          {% if job.recruiter.profile.linkedin %}
          <p class="text-dark"><strong>LinkedIn:</strong> <a href="{{ job.recruiter.profile.linkedin }}" target="_blank">{{ job.recruiter.profile.linkedin }}</a></p>
          {% endif %}
          {% if job.recruiter.website %}
          <p class="text-dark"><strong>Website:</strong> <a href="{{ job.recruiter.website }}" target="_blank">{{ job.recruiter.website }}</a></p>
          {% endif %}

          <!-- Apply Button -->
          <div class="mt-4">
            <a href="{% url 'job:apply_job' job.id %}" class="btn btn-success btn-lg rounded-pill">Apply Now</a>
          </div>

        </div>
      </div>

    </div>
  </div>
</section>
<!-- Live Chat Button -->
<a href="{% url 'chat:start_chat' job.recruiter.id %}" 
   class="btn btn-primary live-chat-btn">
   ðŸ’¬ Live Chat
</a>

<style>
.live-chat-btn {
    position: fixed;
    bottom: 40px;   /* distance from bottom of the screen */
    right: 40px;    /* distance from right of the screen */
    z-index: 9999;  /* ensures it stays above other content */
    border-radius: 50px;  /* rounded button */
    padding: 20px 25px;   /* button padding */
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}
</style>

{% endblock %}
